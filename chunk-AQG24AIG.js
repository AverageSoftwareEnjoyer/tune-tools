import{a as k}from"./chunk-UIC67TDF.js";import{a as A}from"./chunk-PBZUNTEJ.js";import{a as u,b as D,c as O}from"./chunk-UIRHOOJ3.js";import"./chunk-CZZRNV4R.js";import{c as F}from"./chunk-URFFSWQT.js";import"./chunk-FS4ND72F.js";import{Hb as L,Kb as $,W as S,Yb as R,a as g,aa as l,b as d,d as o,e as p,f as T,fb as j,ga as h,ka as x,n as b,r as y,sb as w,ta as C,tb as B,v as I}from"./chunk-Y3DDOGII.js";var M=(()=>{var e,n;let t=class t{constructor(){p(this,e,`${A.apiBaseUrl}/me/top`);p(this,n,h(F))}getTopItems$(r,i){return o(this,n).get(`${o(this,e)}/${r}`,{params:i})}};e=new WeakMap,n=new WeakMap,t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=l({token:t,factory:t.\u0275fac,providedIn:"root"});let s=t;return s})();var H=(()=>{let e=class e{convertTopTrackToLimited(t){let{album:a,external_urls:r,name:i,artists:f}=structuredClone(t);return{album:this.convertAlbumToLimited(a),external_urls:r,name:i,artists:f.map(m=>this.convertTopArtistToLimited(m))}}convertAlbumToLimited(t){let{external_urls:a,name:r,album_type:i,total_tracks:f,images:m,release_date:c}=structuredClone(t);return{external_urls:a,name:r,album_type:i,total_tracks:f,images:m,release_date:c}}convertTopArtistToLimited(t){let{external_urls:a,name:r,images:i,genres:f}=structuredClone(t);return{external_urls:a,name:r,images:i,genres:f}}};e.\u0275fac=function(a){return new(a||e)},e.\u0275prov=l({token:e,factory:e.\u0275fac,providedIn:"root"});let s=e;return s})();var U=(()=>{var e,n,t,a,r;let i=class i{constructor(){p(this,e);p(this,n);p(this,t);p(this,a);p(this,r);T(this,e,h(M)),T(this,n,h(H)),T(this,t,j({itemsByTimeRange:{[u.ShortTerm]:[],[u.MediumTerm]:[],[u.LongTerm]:[]},currentTimeRange:u.ShortTerm})),this.topTracks=R(()=>o(this,t).call(this).itemsByTimeRange[o(this,t).call(this).currentTimeRange]),this.topTracksTimeRange=R(()=>o(this,t).call(this).currentTimeRange),T(this,a,new b),T(this,r,o(this,a).pipe(S(m=>{let c=o(this,t).call(this).itemsByTimeRange[m];return c.length?y(c):o(this,e).getTopItems$("tracks",{time_range:m,limit:50,offset:0}).pipe(I(({items:G})=>G.map(N=>o(this,n).convertTopTrackToLimited(N))))}))),o(this,a).pipe(k()).subscribe(m=>{o(this,t).update(c=>d(g({},c),{currentTimeRange:m}))}),o(this,r).pipe(k()).subscribe(m=>o(this,t).update(c=>d(g({},c),{itemsByTimeRange:d(g({},c.itemsByTimeRange),{[c.currentTimeRange]:m})})))}publishTopTracksTimeRange(m){o(this,a).next(m)}};e=new WeakMap,n=new WeakMap,t=new WeakMap,a=new WeakMap,r=new WeakMap,i.\u0275fac=function(c){return new(c||i)},i.\u0275prov=l({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})();var E=(()=>{var e;let n=class n{constructor(){p(this,e);this.timeRange=u.ShortTerm,T(this,e,h(U))}ngOnChanges(){o(this,e).publishTopTracksTimeRange(this.timeRange)}};e=new WeakMap,n.\u0275fac=function(r){return new(r||n)},n.\u0275cmp=x({type:n,selectors:[["app-top-tracks"]],inputs:{timeRange:"timeRange"},standalone:!0,features:[C,$],decls:2,vars:0,template:function(r,i){r&1&&(w(0,"p"),L(1,"top-tracks works!"),B())},changeDetection:0});let s=n;return s})();var ft=[{path:":timeRange",component:E,canActivate:[O(D.TopTracks)]},{path:"**",redirectTo:u.ShortTerm}];export{ft as default};
//# sourceMappingURL=chunk-AQG24AIG.js.map
